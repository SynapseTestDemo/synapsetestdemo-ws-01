{
	"name": "MV Build",
	"properties": {
		"folder": {
			"name": "Set up scripts"
		},
		"content": {
			"query": "ALTER MATERIALIZED VIEW wwi.MV_SalesByLocation REBUILD;\n\nCREATE MATERIALIZED VIEW wwi.MV_SalesByLocation\nWITH (\n    DISTRIBUTION = ROUND_ROBIN\n)\nAS SELECT \n    l.City,\n    l.Region,\n    s.Description,\n    SUM(h.QuantityOnHand) AS TotalInStock,\n    SUM(s.Quantity) AS TotalItemsSold,\n    AVG(s.Profit) AS AvgProfitOnSale,\n    SUM(s.Profit) AS TotalProfit\nFROM wwi.FactSale s \nINNER JOIN wwi.FactStockHolding h\n    ON (s.StockItemKey = h.StockHoldingKey)\nINNER JOIN wwi.DimCity l \n    ON (s.CityKey = l.CityKey)\nWHERE \n   s.Profit > 100 AND s.Profit < 500 AND  h.QuantityOnHand > 0  \nGROUP BY\n    City,\n    Region,\n    Description\n\n\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"name": "WWI_Pool",
				"type": "SqlPool"
			}
		},
		"type": "SqlQuery"
	}
}